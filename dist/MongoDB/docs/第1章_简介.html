<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>简介 | 羊圈</title>
    <meta name="description" content="神羊的羊圈">
    <meta name="theme-color" content="#00adb5">
  <link rel="icon" href="/images/favicon.png">
  <meta itemprop="image" content="/js_tricks/images/favicon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#00adb5">
    
    <link rel="preload" href="/assets/css/0.styles.18cbf62c.css" as="style"><link rel="preload" href="/assets/js/app.c1618cf4.js" as="script"><link rel="preload" href="/assets/js/3.ed1bf183.js" as="script"><link rel="preload" href="/assets/js/18.0fa172d4.js" as="script"><link rel="prefetch" href="/assets/js/1.b3385aaa.js"><link rel="prefetch" href="/assets/js/10.b526617f.js"><link rel="prefetch" href="/assets/js/100.9c76dc44.js"><link rel="prefetch" href="/assets/js/101.6b17334c.js"><link rel="prefetch" href="/assets/js/102.6072298e.js"><link rel="prefetch" href="/assets/js/103.8bf22d9c.js"><link rel="prefetch" href="/assets/js/104.da37280c.js"><link rel="prefetch" href="/assets/js/105.f6adc7cb.js"><link rel="prefetch" href="/assets/js/106.c479af52.js"><link rel="prefetch" href="/assets/js/107.7864a896.js"><link rel="prefetch" href="/assets/js/108.59251a56.js"><link rel="prefetch" href="/assets/js/109.401930b9.js"><link rel="prefetch" href="/assets/js/11.8c8a17aa.js"><link rel="prefetch" href="/assets/js/110.7f385c95.js"><link rel="prefetch" href="/assets/js/111.874ae40f.js"><link rel="prefetch" href="/assets/js/112.b88da53c.js"><link rel="prefetch" href="/assets/js/12.9a241d83.js"><link rel="prefetch" href="/assets/js/13.50f10eff.js"><link rel="prefetch" href="/assets/js/14.e6ebc69a.js"><link rel="prefetch" href="/assets/js/15.1145f768.js"><link rel="prefetch" href="/assets/js/16.8f53c91c.js"><link rel="prefetch" href="/assets/js/17.f5d33107.js"><link rel="prefetch" href="/assets/js/19.b3ec819d.js"><link rel="prefetch" href="/assets/js/20.39dd808d.js"><link rel="prefetch" href="/assets/js/21.982519d1.js"><link rel="prefetch" href="/assets/js/22.e43852de.js"><link rel="prefetch" href="/assets/js/23.d20b98a1.js"><link rel="prefetch" href="/assets/js/24.8df2408b.js"><link rel="prefetch" href="/assets/js/25.6b7a2412.js"><link rel="prefetch" href="/assets/js/26.e0d54718.js"><link rel="prefetch" href="/assets/js/27.fa540f01.js"><link rel="prefetch" href="/assets/js/28.12872a08.js"><link rel="prefetch" href="/assets/js/29.a5357381.js"><link rel="prefetch" href="/assets/js/30.877d7c50.js"><link rel="prefetch" href="/assets/js/31.b4278efa.js"><link rel="prefetch" href="/assets/js/32.ebc68bbd.js"><link rel="prefetch" href="/assets/js/33.f08d05c9.js"><link rel="prefetch" href="/assets/js/34.a7d62a8e.js"><link rel="prefetch" href="/assets/js/35.f5d32a01.js"><link rel="prefetch" href="/assets/js/36.1ba48a2d.js"><link rel="prefetch" href="/assets/js/37.3e7062af.js"><link rel="prefetch" href="/assets/js/38.46a40d24.js"><link rel="prefetch" href="/assets/js/39.f11b85d4.js"><link rel="prefetch" href="/assets/js/4.1b01fc51.js"><link rel="prefetch" href="/assets/js/40.28ecd869.js"><link rel="prefetch" href="/assets/js/41.5e8bc3d9.js"><link rel="prefetch" href="/assets/js/42.ff6b4e3c.js"><link rel="prefetch" href="/assets/js/43.9a77ccd5.js"><link rel="prefetch" href="/assets/js/44.b54ec253.js"><link rel="prefetch" href="/assets/js/45.cbee26e2.js"><link rel="prefetch" href="/assets/js/46.5e19d09a.js"><link rel="prefetch" href="/assets/js/47.0acc679f.js"><link rel="prefetch" href="/assets/js/48.bfdd685b.js"><link rel="prefetch" href="/assets/js/49.e42f572c.js"><link rel="prefetch" href="/assets/js/5.d587daef.js"><link rel="prefetch" href="/assets/js/50.85bfbfcd.js"><link rel="prefetch" href="/assets/js/51.576a7373.js"><link rel="prefetch" href="/assets/js/52.f26ffee5.js"><link rel="prefetch" href="/assets/js/53.163cf701.js"><link rel="prefetch" href="/assets/js/54.c1132ecc.js"><link rel="prefetch" href="/assets/js/55.e089f0d4.js"><link rel="prefetch" href="/assets/js/56.be59a8ef.js"><link rel="prefetch" href="/assets/js/57.a015f201.js"><link rel="prefetch" href="/assets/js/58.0235e47f.js"><link rel="prefetch" href="/assets/js/59.0b6f5acf.js"><link rel="prefetch" href="/assets/js/6.69e07e2c.js"><link rel="prefetch" href="/assets/js/60.641c2f95.js"><link rel="prefetch" href="/assets/js/61.17b03fa8.js"><link rel="prefetch" href="/assets/js/62.96134956.js"><link rel="prefetch" href="/assets/js/63.f845d120.js"><link rel="prefetch" href="/assets/js/64.e9ed93d9.js"><link rel="prefetch" href="/assets/js/65.2bd53147.js"><link rel="prefetch" href="/assets/js/66.1f03bf79.js"><link rel="prefetch" href="/assets/js/67.47eb30d1.js"><link rel="prefetch" href="/assets/js/68.cc339c5a.js"><link rel="prefetch" href="/assets/js/69.2ff09789.js"><link rel="prefetch" href="/assets/js/7.3199f861.js"><link rel="prefetch" href="/assets/js/70.9d03d949.js"><link rel="prefetch" href="/assets/js/71.7eab78cd.js"><link rel="prefetch" href="/assets/js/72.20dd5f6e.js"><link rel="prefetch" href="/assets/js/73.6c6af6b0.js"><link rel="prefetch" href="/assets/js/74.8eed043b.js"><link rel="prefetch" href="/assets/js/75.3b5158cd.js"><link rel="prefetch" href="/assets/js/76.0eacd2d9.js"><link rel="prefetch" href="/assets/js/77.c3ba3709.js"><link rel="prefetch" href="/assets/js/78.843656e9.js"><link rel="prefetch" href="/assets/js/79.99bae0b9.js"><link rel="prefetch" href="/assets/js/8.8d4fcdde.js"><link rel="prefetch" href="/assets/js/80.4d3c67b0.js"><link rel="prefetch" href="/assets/js/81.85eaf0e7.js"><link rel="prefetch" href="/assets/js/82.27feb7aa.js"><link rel="prefetch" href="/assets/js/83.7686c618.js"><link rel="prefetch" href="/assets/js/84.941fa5d5.js"><link rel="prefetch" href="/assets/js/85.46a4182a.js"><link rel="prefetch" href="/assets/js/86.1d2fa06f.js"><link rel="prefetch" href="/assets/js/87.1fa71add.js"><link rel="prefetch" href="/assets/js/88.a9a069f0.js"><link rel="prefetch" href="/assets/js/89.93d73858.js"><link rel="prefetch" href="/assets/js/9.99351bd6.js"><link rel="prefetch" href="/assets/js/90.029a12be.js"><link rel="prefetch" href="/assets/js/91.669f4475.js"><link rel="prefetch" href="/assets/js/92.686c84ef.js"><link rel="prefetch" href="/assets/js/93.47bd8585.js"><link rel="prefetch" href="/assets/js/94.0b908759.js"><link rel="prefetch" href="/assets/js/95.f4d85cb9.js"><link rel="prefetch" href="/assets/js/96.e57f6246.js"><link rel="prefetch" href="/assets/js/97.b5660771.js"><link rel="prefetch" href="/assets/js/98.91198c9e.js"><link rel="prefetch" href="/assets/js/99.9a6c1efc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.18cbf62c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">羊圈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">blog</a></div><div class="nav-item"><a href="https://qishaoxuan.github.io/animate_resume/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  about me
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">blog</a></div><div class="nav-item"><a href="https://qishaoxuan.github.io/animate_resume/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  about me
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/1.基础知识.html" class="sidebar-link">基础知识</a></li><li><a href="/js/2.数据类型.html" class="sidebar-link">数据类型</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="简介">简介</h2> <p>MongoDB 是一个跨平台，面向文档的数据库，高性能，高可用性和易于扩展。</p> <ul><li>数据库:数据库是一个集合的物理容器,一个单一的 MongoDB 服务器通常有多个数据库。</li> <li>集合:集合是一组 MongoDB 的文件。简单理解就是一个数组 (集合里面存放 json 对象 collection('one');</li> <li>文档 : 文档是一组键值对。(可以认为是 json 格式,但其实是 bson, bson 基于 json 格式)</li></ul> <h2 id="安装">安装</h2> <p><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol><li>下载 Community Server 版，直接安装（不需要安装 Compass）。</li> <li>在 c 盘根目录下新建 data/db</li> <li>进入安装文件夹的 bin 目录下，将该文件夹目录添加至系统环境变量</li></ol> <p>验证</p> <div class="language- extra-class"><pre class="language-text"><code>mongo --version
</code></pre></div><h2 id="使用">使用</h2> <p>启动服务</p> <div class="language- extra-class"><pre class="language-text"><code>mongod  //win下直接使用c:data/db
mongod --dbpath D:\mongo-data //选定数据库目录

// 如果不加--dbpath, mongod 会自动使用 `执行命令所属磁盘根目录`下面的/data/db 目录作为自己的数据存储路径，
</code></pre></div><p><strong>注：启动服务的这个窗口不能直接关闭，需要使用<code>ctrl</code>+<code>c</code>命令关闭服务后才能关闭，否则需要去任务管理器关闭，再找到 <code>mongod.lock</code> 删掉</strong></p> <p>连接数据库</p> <div class="language- extra-class"><pre class="language-text"><code>mongo //默认使用 27017 端口
// 也可以通过下面的命令，指定连接的主机名和端口号：
mongo --host 127.0.0.1 --port 27017
</code></pre></div><p>查看所有数据库</p> <div class="language- extra-class"><pre class="language-text"><code>show dbs
</code></pre></div><p>查看当前数据库</p> <div class="language- extra-class"><pre class="language-text"><code>db
</code></pre></div><p>新建数据库</p> <div class="language- extra-class"><pre class="language-text"><code>use 数据库名 //如果在创建的数据库里,不创建集合,退出后,数据库也就消失了
</code></pre></div><p>新建集合</p> <div class="language- extra-class"><pre class="language-text"><code>db.集合名.inserOne() //插入单条数据
db.集合名.inserMany() //插入多条数据（数组形式）
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// 1. 插入一条
&gt; db.news.insertOne({id:1, title:&quot;news title&quot;, url:&quot;http://www.baidu.com&quot;, text:&quot;百度一下，你就知道&quot;});
&gt; WriteResult({ &quot;nInserted&quot; : 1 })   // insert 成功

// 2. 插入多条  [{},{},{}]  数组里有对象
db.news01.insertMany([
  { title: &quot;张三&quot;,  url: 'www.zhangsan.com', text:'我是张三,谁与我争雄'},
  { title: &quot;李四&quot;,  url: 'www.lisi.com', text:'我是李四,我不爱女人,只爱妖妖'},
  { title: &quot;王五&quot;,  url: 'www.wangwu.com', text:'我住隔壁,我姓王'}
])
&gt; {                                  // 插入多条成功
	&quot;acknowledged&quot; : true,
	&quot;insertedIds&quot; : [
		ObjectId(&quot;59fcc3f96208a88400da6d6e&quot;),
		ObjectId(&quot;59fcc3f96208a88400da6d6f&quot;),
		ObjectId(&quot;59fcc3f96208a88400da6d70&quot;)
	]
}
</code></pre></div><p>查询集合中的所有数据</p> <div class="language- extra-class"><pre class="language-text"><code>db.集合名称.find()
</code></pre></div><p>根据条件查询该集合某一条/多条数据</p> <div class="language- extra-class"><pre class="language-text"><code>db. 集合. find(条件)
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>&gt;单条: db.aaa.find({age:18})
// gt: greater than
// lt: less than
// e: equal
// ne: not equal
&gt;多条: db.aaa.find({age:{$gte:18}})   // 查看 age &gt;= 18 的
{ &quot;_id&quot; : ObjectId(&quot;59fcb97f6208a88400da6d65&quot;), &quot;name&quot; : &quot;xingge&quot;, &quot;age&quot; : 18 }
{ &quot;_id&quot; : ObjectId(&quot;59fcbee26208a88400da6d69&quot;), &quot;nage&quot; : &quot;huge&quot;, &quot;age&quot; : 19 }
</code></pre></div><p>更新指定集合数据</p> <div class="language- extra-class"><pre class="language-text"><code>db.集合名称.update({更新条件},{$set:{要更新的字段}})
</code></pre></div><ul><li>更新指定集合数据</li> <li>满足一个条件的多个数据修改,还要在后面添加 ,<code>{multi:true}</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>//1. 替换
// db.one.update({查询条件},{替换内容})
db.one.update({age:11},{name:'haha'})

//2. 单个更新
// db.one.update({查询条件},{$set:{更新内容}})
db.one.update({age:'12',{$set:{name:'haha'}}})

//2. 更改多个符合条件的  :  {multi:true}
&gt; db.aaa.update({age:18},{$set:{name:'xiaomage'}},{multi:true})
WriteResult({ &quot;nMatched&quot; : 2, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 2 })  //更新成功
</code></pre></div><p>删除集合的某个文档</p> <div class="language- extra-class"><pre class="language-text"><code>db.集合名称.remove({删除条件})
</code></pre></div><p>删除集合</p> <div class="language- extra-class"><pre class="language-text"><code>db.集合名称.drop()
</code></pre></div><p>删除数据库</p> <div class="language- extra-class"><pre class="language-text"><code>db.dropDatabase()
</code></pre></div><ul><li>参考文档：https://docs.mongodb.com/manual/crud/</li> <li>参考文档:http://www.runoob.com/mongodb/mongodb-update.html (推荐)</li></ul> <h2 id="node-操作-mongodb">node 操作 mongodb</h2> <p>需要使用 MongoDB 驱动器</p> <p>这个 MongoDB 是 MongoDB 驱动器 (driver) ，也是 node 的第三方包 帮助 nodejs 来操作 mongo 数据库的，虽然名字一样，但是实质不一样</p> <div class="language- extra-class"><pre class="language-text"><code>var mongodb = require('mongodb');

var mc =  mongodb.MongoClient;

var url = 'mongodb://127.0.0.1:27017';

// 开始连接
mc.connect(url,function(err,client){
    if(err){
        throw err;
        return;
    }
    console.log(&quot;连接数据库成功&quot;);

    client.db('test').collection('shen').insertOne({id:2,title:'呵呵'},function(err){
        if(err){
            throw err;
            return;
        }
        client.close();//关闭数据库
        console.log('插入成功');
    })
})
</code></pre></div><h3 id="crud-增删改查">CRUD (增删改查)</h3> <ol><li><p>连接数据库服务器:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//准备工作:  加载 mongodb</span>
<span class="token keyword">var</span> mongodb <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//1. 获取连接数据库的连接对象</span>
<span class="token keyword">var</span> mc <span class="token operator">=</span> mongodb<span class="token punctuation">.</span>MongoClient<span class="token punctuation">;</span>

<span class="token comment">//2. 连接数据库的连接字符串(连接地址)</span>
<span class="token comment">// 'mongodb://192.168.22.22:27017'</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;mongodb://127.0.0.1:27017&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//3. 开始连接</span>
<span class="token comment">//client 具有操作数据库能力的对象</span>
mc<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> client</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接数据库成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>​</p></li> <li><p>插入单条数据</p> <ul><li>使用方法: **db . collection(XX) . insertOne ( { 数据 } , callback(err) ) **</li></ul></li></ol> <ul><li>insert( {数据 }, callback ) — 已经废弃</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. 插入单条数据</span>
<span class="token comment">// [注意1] 插入数据是异步的  所以要有个回调函数</span>
<span class="token comment">// [注意2] insert() 在 3.2版本之后,已经慢慢被废弃,插入单条的话</span>
<span class="token comment">//        使用 insetOne()</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;heros&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;呵呵&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//{ result: { ok: 1, n: 1 },</span>
  <span class="token comment">// ops: [ { name: '呵呵', age: 18, _id: 59fd23fd2ae663070b66a4f7 } ],</span>
  <span class="token comment">// insertedCount: 1,</span>
  <span class="token comment">// insertedIds: [ 59fd23fd2ae663070b66a4f7 ] }</span>

  <span class="token comment">//[注意] 取值之后,一定要记得关闭数据库</span>
  db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>​</p> <ol><li><p>插入多条数据</p> <ul><li>使用方法 : <strong>insertMany ( [ { 数据 1 } , { 数据 2 }] , callback(err) )</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//2. 插入多条数据</span>
<span class="token comment">// [注意] 插入数据是异步的</span>
<span class="token comment">// 所以要有个回调函数</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;heros&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertMany</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;pp&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">80</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;dd&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;xx&quot;</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token number">19</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// { result: { ok: 1, n: 3 },</span>
    <span class="token comment">// ops:</span>
    <span class="token comment">//  [ { name: 'pp', age: 80, _id: 59fd24e2b28af807465884cc },</span>
    <span class="token comment">//    { name: 'dd', age: 18, _id: 59fd24e2b28af807465884cd },</span>
    <span class="token comment">//    { name: 'xx', age: 19, _id: 59fd24e2b28af807465884ce } ],</span>
    <span class="token comment">// insertedCount: 3,</span>
    <span class="token comment">// insertedIds:</span>
    <span class="token comment">//  [ 59fd24e2b28af807465884cc,</span>
    <span class="token comment">//    59fd24e2b28af807465884cd,</span>
    <span class="token comment">//    59fd24e2b28af807465884ce ] }</span>
    <span class="token comment">//[注意] 取值之后,一定要记得关闭数据库</span>
    db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>​</p></li> <li><p>查询全部数据</p> <ul><li>使用方法 : <strong>find ( ) . toArray ( callback(err,docs) )</strong> : 条件可有可无</li> <li>打印的 doc: 是一个<strong>数组</strong>, (查询首页列表适合用)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//5. 获取数据</span>
  db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'heros'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err
    <span class="token punctuation">}</span>

    <span class="token comment">// [查询多条的区别]</span>
    <span class="token comment">// 1. find().toArray(callback)</span>
    <span class="token comment">// 2. doc 是一个数据集合</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span>

    db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>​</p></li> <li><p>查询单条数据</p> <ul><li>使用方法 : <strong>findOne( {条件} , callback(err,doc) )</strong></li> <li>doc 打印的是一个 <strong>对象</strong> : (查询某个详情页适合用)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//5.查询单条数据</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;heros&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 打印的是一个对象</span>
  <span class="token comment">//{ _id: 59fd259fc83c80e709dff4dc, name: '老宫', age: 16 }</span>

  <span class="token comment">// 异步里关闭数据库</span>
  db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>​</p></li> <li><p>更新数据</p> <ul><li><p><strong>单条: update ( {条件} , { $set: {更新字段 }} , callback )</strong></p></li> <li><p><strong>多条 : update Many ( {条件} , { $set: {更新字段 }} , callback )</strong></p></li> <li><p><strong>替换 : update ( {条件} , {更新字段 } , callback )</strong></p></li> <li><p>{age:14 name='鸭王'}</p></li> <li><p>updateOne({age:14}, {$set: { aa:11,bb:44 } } )</p></li> <li><p>=&gt; {age:14 name='鸭王 ' aa:11 bb:44 }</p></li> <li><p>更新多条: <strong>updateMany</strong></p></li> <li><p>如果只跟新一条是用$ set, 如果工作中的编辑页面是要获取所有的信息都要更新一遍的</p> <p>所以,直接写对象即可,不用$ set 了</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//5. 更新数据</span>
<span class="token comment">// update(参数1,参数2,回调)</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;heros&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $<span class="token keyword">set</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;丹丹&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>​</p></li> <li><p>删除数据</p> <ul><li>删除单条: <strong>deleteOne ( {条件} , callback )</strong></li> <li>删除多条: <strong>deleteMany ( {条件} , callback )</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//6.删除</span>
<span class="token comment">//删除多条 deleteMany()</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">&quot;heros&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;删除成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//6. 关闭数据库</span>
  db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div></div></div>
    <script src="/assets/js/app.c1618cf4.js" defer></script><script src="/assets/js/3.ed1bf183.js" defer></script><script src="/assets/js/18.0fa172d4.js" defer></script>
  </body>
</html>
